<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°æµ·ç‰¹è¨“å®¤ | VIP å°ˆå±¬</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #0f172a; color: white; }
        .glass-panel { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .hidden-content { display: none; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <nav class="p-4 flex justify-between items-center border-b border-slate-800 bg-slate-900/80 fixed w-full z-50 backdrop-blur-md">
        <a href="index.html" class="flex items-center gap-2 hover:text-yellow-400 transition text-sm font-bold text-gray-300">
            <i data-lucide="arrow-left"></i> è¿”å›å®˜ç¶²
        </a>
        <div class="font-bold text-lg tracking-wider text-yellow-500 flex items-center gap-2">
            <i data-lucide="shield-check" class="w-5 h-5"></i> å°æµ·ç‰¹è¨“å®¤
        </div>
    </nav>

    <section id="login-section" class="flex-1 flex flex-col items-center justify-center p-4 min-h-screen">
        <div class="glass-panel p-8 rounded-2xl max-w-md w-full text-center shadow-2xl">
            <div class="w-16 h-16 bg-yellow-500/20 text-yellow-500 rounded-full flex items-center justify-center mx-auto mb-6">
                <i data-lucide="lock" class="w-8 h-8"></i>
            </div>
            <h1 class="text-2xl font-bold mb-2">å°æµ·ç‰¹è¨“å®¤</h1>
            <p class="text-slate-400 text-sm mb-8">è«‹è¼¸å…¥æ‚¨çš„ VIP ä¿¡ç®±é€²è¡Œèº«åˆ†é©—è­‰</p>
            
            <div class="space-y-4">
                <input type="email" id="emailInput" placeholder="name@example.com" 
                    class="w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 text-white text-center">
                <button id="verifyBtn" class="w-full bg-gradient-to-r from-yellow-500 to-orange-500 text-slate-900 font-black py-3 rounded-lg shadow-lg">
                    è§£é–ç‰¹è¨“å…§å®¹
                </button>
            </div>
            
            <div id="error-container" class="hidden mt-4 bg-red-900/30 p-3 rounded-lg border border-red-800/50">
                <p class="text-red-400 text-xs">âŒ æ­¤ä¿¡ç®±æœªåœ¨ç‰¹è¨“åå–®ä¸­</p>
            </div>
        </div>
    </section>

    <section id="content-section" class="hidden-content pt-24 pb-16 px-4 max-w-4xl mx-auto w-full space-y-12">
        <div class="text-center">
            <span class="text-yellow-500 font-bold tracking-widest text-xs border border-yellow-500/30 px-3 py-1 rounded-full bg-yellow-500/10">VIP TRAINING</span>
            <h1 class="text-3xl font-black mt-4">å­¸å“¡å°ˆå±¬å¤§ç›¤è¶¨å‹¢</h1>
        </div>

        <div id="vipPostsContainer" class="space-y-8">
            <div class="text-center py-10 text-slate-500">æ­£åœ¨åŠ è¼‰ç‰¹è¨“è³‡æ–™...</div>
        </div>

        <div class="mt-16 text-center border-t border-slate-800 pt-8">
            <button onclick="logout()" class="text-slate-500 text-sm hover:text-white transition flex items-center justify-center gap-2 mx-auto">
                <i data-lucide="log-out" class="w-4 h-4"></i> ç™»å‡ºç‰¹è¨“å®¤
            </button>
        </div>
    </section>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, collection, query, where, getDocs, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBi7FXRLt9qiVNa-qipPo-OD-b_qseQHUQ",
            authDomain: "gen-lang-client-0733075059.firebaseapp.com",
            projectId: "gen-lang-client-0733075059",
            storageBucket: "gen-lang-client-0733075059.firebasestorage.app",
            messagingSenderId: "561243064522",
            appId: "1:561243064522:web:cdfffd357c9af417b08c33",
            measurementId: "G-D93F1E1GR3"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app, "seawebfire");
        const auth = getAuth(app);

        const emailInput = document.getElementById('emailInput');
        const loginSection = document.getElementById('login-section');
        const contentSection = document.getElementById('content-section');
        const errorContainer = document.getElementById('error-container');

        // æª¢æŸ¥ç™»å…¥ç‹€æ…‹
        const savedEmail = localStorage.getItem('littleSeaVIP');
        if(savedEmail) showContent();

        document.getElementById('verifyBtn').addEventListener('click', async () => {
            const email = emailInput.value.trim().toLowerCase();
            if(!email) return;

            // ğŸ”´ å¾è³‡æ–™åº«é©—è­‰ Email
            const q = query(collection(db, "vip_members"), where("email", "==", email));
            const snapshot = await getDocs(q);

            if (!snapshot.empty) {
                localStorage.setItem('littleSeaVIP', email);
                showContent();
            } else {
                errorContainer.classList.remove('hidden');
            }
        });

        function showContent() {
            loginSection.classList.add('hidden');
            contentSection.classList.remove('hidden-content');
            lucide.createIcons();
            loadVipPosts();
        }

        // ğŸŸ¢ æŠ“å–åˆ†é¡ç‚ºã€Œç‰¹è¨“å€ã€çš„æ–‡ç« 
        function loadVipPosts() {
            const q = query(collection(db, "posts"), where("category", "==", "ç‰¹è¨“å€"), orderBy("timestamp", "desc"));
            onSnapshot(q, (snapshot) => {
                const container = document.getElementById('vipPostsContainer');
                container.innerHTML = '';
                if(snapshot.empty) {
                    container.innerHTML = '<p class="text-center text-slate-500">ç›®å‰å°šç„¡ç‰¹è¨“è³‡æ–™ã€‚</p>';
                    return;
                }
                snapshot.forEach(doc => {
                    const post = doc.data();
                    const date = post.timestamp ? new Date(post.timestamp.seconds * 1000).toLocaleDateString() : '';
                    container.insertAdjacentHTML('beforeend', `
                        <article class="glass-panel p-6 rounded-2xl border-l-4 border-yellow-500">
                            <div class="text-yellow-500 text-xs font-mono mb-2">${date}</div>
                            <h2 class="text-xl font-bold text-white mb-4">${post.title}</h2>
                            <div class="text-slate-300 leading-relaxed whitespace-pre-wrap">${post.content}</div>
                        </article>
                    `);
                });
            });
        }

        window.logout = () => { localStorage.removeItem('littleSeaVIP'); location.reload(); };
        lucide.createIcons();
    </script>
</body>
</html>